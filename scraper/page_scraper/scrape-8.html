<html>
	<body>
		<!-- Lo script funziona se inserito su htdocs-->
		<script src="../lib/js/jquery.min.js"></script>
		<script src="../lib/js/jquery.xdomainajax.js"></script>

		<script type="text/javascript">

		var url1 = "https://en.wikipedia.org/wiki/Walter_Sisulu"
		var url3 = "https://en.wikipedia.org/wiki/Mahatma_Gandhi"
		var url7 = "https://en.wikipedia.org/wiki/Africa_Day"

		var url8 = "https://en.wikipedia.org/wiki/Special:WhatLinksHere/Walter_Sisulu&limit=500"
		var url9 = "https://en.wikipedia.org/w/api.php?action=query&list=backlinks&bltitle=Nelson_Mandela&bllimit=500&format=json"

		var url2 = "http://en.wikipedia.org/w/index.php?title=Nelson_Mandela&action=history" // non funziona
		var url4 = "https://en.wikipedia.org/w/index.php?title=Mahatma_Gandhi&action=edit" // non funziona
		var url5 = "https://en.wikipedia.org/w/index.php?title=Mahatma_Gandhi&action=info" // non funziona
		var url6 = "http://en.wikipedia.org/wiki/Special:WhatLinksHere/Mahatma_Gandhi" // non funziona
	
		var baseurl = window.location.origin; // +window.location.pathname;

		var proxy = baseurl + "/wikimole/scraper/page_scraper/proxy.php" //http://localhost:8888/wikimole/scraper/
		var proxy_1 = baseurl + "/wikimole/scraper/page_scraper/proxy_1.php" 
		var proxy_2 = baseurl + "/wikimole/scraper/page_scraper/proxy_2.php" 


		var url_a = proxy + "?url=" + url1
		var url_b = proxy + "?url=" + url3
		

			var queue = [
				"https://en.wikipedia.org/wiki/Walter_Sisulu",
				"https://en.wikipedia.org/wiki/Mahatma_Gandhi",
				//"https://en.wikipedia.org/wiki/Africa_Day"
				];

				console.log("queue: " + queue)

			for (var i = 0; i < 1; i++) {

				var myqueue = $.each(queue, function(index,val){
						console.log("val: " + val)
					})

			    $.ajax({
	        		type: 'GET',
	        		url: proxy + "?url=" + myqueue,
	        		processData: true,
	        	})
	        	.done (function (res_1) {

		        	var parsedata_for_1 = $.parseHTML(res_1);

			      	references_1 = []
			      	references_1 = ($(parsedata_for_1).find('.references'))

			      	//console.log(proxy + "?url=" + queue)

			      	//console.log(myqueue)

					//$('#content' + i ).html(references_1)

				})
			}




			$.ajax({
	       		type: 'GET',
	       		url: proxy + "?url=" + url1,
	       		processData: true,
	       	})
	       	.done (function (res_a) {
	       		var pars_1 = $.parseHTML(res_a);

			    ref_1 = []
			  	ref_1 = ($(pars_1).find('.references'))

			  	$('#content1').html(ref_1)
	       	
	       	})

	       	$.ajax({
	       		type: 'GET',
	       		url: proxy_1 + "?url=" + url3,
	       		processData: true,
	       	})
	       	.done (function (res_b) {
	       		var pars_2 = $.parseHTML(res_b);

			    ref_2 = []
			  	ref_2 = ($(pars_2).find('.references'))
	       		
	       		$('#content2').html(ref_2)

	       	})


/*  -----  */

	       	
	       	function scrape_ref(url,prox) {
			    
			    $.ajax({
			    	crossOrigin: true,
		           	type: 'GET',
		           	url: prox + "?url=" + url,
		           	processData: true,
		           	dataType: 'json',
		        })
		        .done (function (res_func) {

		        	var parsedata_func = $.parseHTML(res_func);

		        	ref_func = []
					ref_func = ($(parsedata_func).find('#mw-whatlinkshere-list')) //.references

					container = $('#content4')

					container.html(ref_func) 

				});
			};

			scrape_ref(url9,proxy_2)	


			//scrape_ref('https://en.wikipedia.org/wiki/Walter_Sisulu',proxy)
			//scrape_ref('https://en.wikipedia.org/wiki/Africa_Day',proxy_1)	
			



/*  -----  */
		
			console.log('test: 1')

			console.log(proxy_2 + "?url=" + url9)

	       	console.log(proxy + "?url=" + url1)
	        console.log(proxy_1 + "?url=" + url3)


		</script>

	<main>
		<h1>Content</h1>
		<!--<button id="trigger">GET data</button>-->

		<p>Se non riesco a screpare qualcosa, usare Scraper (estensione Chrome), Outbit</p>
		<div id="response"></div>
		<div id="content8" class="box"></div>
		<div id="content9" class="box"></div>
		<div id="content10" class="box"></div>
		<div id="content11" class="box"></div>

		<div class="clear"></div>

		<div id="content1" class="box"></div>
		<div id="content2" class="box"></div>
		<div id="content3" class="box"></div>
		<div id="content4" class="box"></div>
		<div id="content5" class="box"></div>
		<div id="content6" class="box"></div>
		<div id="content7" class="box"></div>
		
		
	</main>


	</body>

	<style>
		#content{
			width: 80%;
			height: 300px;
		}
		.box{
			width: 18%;
			float:left;
		}
		.clear{
			clear: both;
		}
	</style>

</html>


<!--

Function for call the proxy
http://goobbe.com/questions/2928320/how-to-call-more-than-one-url-from-one-button-in-jquery-ajax


Convertitore Unix timestamp to Readable Date/time
http://www.onlineconversion.com/unix_time.htm

http://www.4guysfromrolla.com/articles/102710-1.aspx


-->